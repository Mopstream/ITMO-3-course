-- 1 --
select Н_ТИПЫ_ВЕДОМОСТЕЙ.НАИМЕНОВАНИЕ, Н_ВЕДОМОСТИ.ЧЛВК_ИД 
from Н_ТИПЫ_ВЕДОМОСТЕЙ
join Н_ВЕДОМОСТИ on Н_ВЕДОМОСТИ.ВЕД_ИД = Н_ТИПЫ_ВЕДОМОСТЕЙ.ИД
where 
    -- Н_ТИПЫ_ВЕДОМОСТЕЙ.НАИМЕНОВАНИЕ > 'Ведомость';
    -- Н_ВЕДОМОСТИ.ЧЛВК_ИД < 142390;
    -- Н_ВЕДОМОСТИ.ЧЛВК_ИД = 163249;
     
     
     
-- 2 --     
select Н_ЛЮДИ.ФАМИЛИЯ, Н_ВЕДОМОСТИ.ЧЛВК_ИД, Н_СЕССИЯ.ЧЛВК_ИД
from Н_ЛЮДИ
join Н_ВЕДОМОСТИ on Н_ВЕДОМОСТИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД
join Н_СЕССИЯ on Н_СЕССИЯ.ЧЛВК_ИД = Н_ЛЮДИ.ИД
where 
 -- Н_ЛЮДИ.ФАМИЛИЯ = 'Ёлкин';
 -- Н_ВЕДОМОСТИ.ЧЛВК_ИД < 117219;
     
     

-- 3 --
select count(Н_ЛЮДИ.ИД) from Н_ЛЮДИ
join Н_УЧЕНИКИ on Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД
join Н_ПЛАНЫ on Н_ПЛАНЫ.ИД = Н_УЧЕНИКИ.ПЛАН_ИД
join Н_ОТДЕЛЫ on Н_ОТДЕЛЫ.ИД = Н_ПЛАНЫ.ОТД_ИД
where Н_ОТДЕЛЫ.КОРОТКОЕ_ИМЯ = 'КТиУ' and
      Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ > '11.10.2003';



-- 4 --
select Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД from Н_ГРУППЫ_ПЛАНОВ
join Н_ПЛАНЫ on Н_ПЛАНЫ.ИД = Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД
join Н_ФОРМЫ_ОБУЧЕНИЯ on Н_ФОРМЫ_ОБУЧЕНИЯ.ИД = Н_ПЛАНЫ.ФО_ИД
where Н_ФОРМЫ_ОБУЧЕНИЯ.НАИМЕНОВАНИЕ = 'Заочная'
group by Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД
having count(Н_ГРУППЫ_ПЛАНОВ.ГРУППА) > 2;



-- 5 --
select (Н_УЧЕНИКИ.ЧЛВК_ИД, avg(cast(Н_ВЕДОМОСТИ.ОЦЕНКА as numeric))) from Н_УЧЕНИКИ
join Н_ВЕДОМОСТИ on Н_ВЕДОМОСТИ.ЧЛВК_ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
where Н_УЧЕНИКИ.ГРУППА = '4100' and
      Н_ВЕДОМОСТИ.ОЦЕНКА in ('2','3','4','5')
      group by Н_УЧЕНИКИ.ЧЛВК_ИД
      having (avg(cast(Н_ВЕДОМОСТИ.ОЦЕНКА as numeric))) = (
        select min(cast(Н_ВЕДОМОСТИ.ОЦЕНКА as numeric)) from Н_УЧЕНИКИ
            join Н_ВЕДОМОСТИ on Н_ВЕДОМОСТИ.ЧЛВК_ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
            where Н_УЧЕНИКИ.ГРУППА = '1100' and
            Н_ВЕДОМОСТИ.ОЦЕНКА in ('2','3','4','5'));


-- 6 --
select (Н_УЧЕНИКИ.ГРУППА, Н_ЛЮДИ.ИД, Н_ПЛАНЫ.ИД) from Н_ЛЮДИ
join Н_УЧЕНИКИ on Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД
join Н_ПЛАНЫ on Н_ПЛАНЫ.ИД = Н_УЧЕНИКИ.ПЛАН_ИД
join Н_ФОРМЫ_ОБУЧЕНИЯ on Н_ФОРМЫ_ОБУЧЕНИЯ.ИД = Н_ПЛАНЫ.ФО_ИД
join Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ on Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ.ИД = Н_ПЛАНЫ.НАПС_ИД
join Н_НАПР_СПЕЦ on Н_НАПР_СПЕЦ.ИД = Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ.НС_ИД
where
    Н_ПЛАНЫ.ДАТА_УТВЕРЖДЕНИЯ > TO_DATE('01/09/2012', 'DD/MM/YYYY') and
    Н_ПЛАНЫ.КУРС = 1 and
    (Н_ФОРМЫ_ОБУЧЕНИЯ.НАИМЕНОВАНИЕ = 'Очная' or
     Н_ФОРМЫ_ОБУЧЕНИЯ.НАИМЕНОВАНИЕ = 'Заочная') and
     exists (
        select 1 from Н_НАПР_СПЕЦ 
        where Н_НАПР_СПЕЦ.ИД = Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ.НС_ИД and
              Н_НАПР_СПЕЦ.НАИМЕНОВАНИЕ = 'Программная инженерия'  
     );
          


-- 7 --
select (ФАМИЛИЯ, ДАТА_РОЖДЕНИЯ)
from Н_ЛЮДИ
where ФАМИЛИЯ in (
  select ФАМИЛИЯ
  from Н_ЛЮДИ
  group by ФАМИЛИЯ
  having count(distinct ДАТА_РОЖДЕНИЯ) > 1
) order by ФАМИЛИЯ;

